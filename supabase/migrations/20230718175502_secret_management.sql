create extension vault with schema vault;

CREATE TYPE provider AS ENUM ('OPENAI', 'ANTHROPIC');

CREATE TABLE provider_keys (
    id bigint generated by default as identity not null primary key,
    org_id UUID NOT NULL REFERENCES public.organization(id),
    provider_key_vault_id UUID NOT NULL REFERENCES vault.secrets(id) UNIQUE,
    provider_key_name TEXT NOT NULL,
    provider_name provider NOT NULL,
    helicone_proxy_key TEXT,
    helicone_key_name TEXT,
    CONSTRAINT org_provider_key_name_uniq UNIQUE (org_id, provider_key_name),
    CONSTRAINT org_provider_helicone_key_name_uniq UNIQUE (org_id, provider_name, helicone_key_name)
);