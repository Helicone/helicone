[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:postgresql]
command=/usr/local/bin/docker-entrypoint.sh postgres
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/postgresql.err.log
stdout_logfile=/var/log/supervisor/postgresql.out.log
user=postgres
environment=POSTGRES_DB=helicone_test,POSTGRES_USER=postgres,POSTGRES_PASSWORD=testpassword

[program:flyway-migrate]
command=/bin/bash -c "sleep 10 && flyway migrate -configFiles=/app/supabase/flyway.conf"
autostart=true
autorestart=false
startsecs=0
startretries=3
stderr_logfile=/var/log/supervisor/flyway.err.log
stdout_logfile=/var/log/supervisor/flyway.out.log
