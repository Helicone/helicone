'use client';
import{__rest as e}from"tslib";import{BaseColors as t}from"../../../lib/constants.js";import{themeColorRange as a,colorPalette as l}from"../../../lib/theme.js";import{tremorTwMerge as i}from"../../../lib/tremorTwMerge.js";import{getColorClassNames as o,defaultValueFormatter as r}from"../../../lib/utils.js";import n,{useState as s}from"react";import{ResponsiveContainer as c,BarChart as m,CartesianGrid as d,XAxis as v,YAxis as u,Tooltip as h,Legend as p,Bar as y}from"recharts";import g from"../common/ChartLegend.js";import f from"../common/ChartTooltip.js";import k from"../common/NoData.js";import{constructCategoryColors as b,deepEqual as x,getYAxisDomain as w}from"../common/utils.js";const E=n.forwardRef(((E,j)=>{const{data:L=[],categories:A=[],index:O,colors:T=a,valueFormatter:C=r,layout:N="horizontal",stack:D=!1,relative:S=!1,startEndOnly:V=!1,animationDuration:F=900,showAnimation:K=!1,showXAxis:G=!0,showYAxis:M=!0,yAxisWidth:z=56,intervalType:P="equidistantPreserveStart",showTooltip:X=!0,showLegend:B=!0,showGridLines:H=!0,autoMinValue:W=!1,minValue:Y,maxValue:q,allowDecimals:I=!0,noDataText:R,onValueChange:$,customTooltip:J,rotateLabelX:Q,className:U,enableLegendSlider:Z=!1}=E,_=e(E,["data","categories","index","colors","valueFormatter","layout","stack","relative","startEndOnly","animationDuration","showAnimation","showXAxis","showYAxis","yAxisWidth","intervalType","showTooltip","showLegend","showGridLines","autoMinValue","minValue","maxValue","allowDecimals","noDataText","onValueChange","customTooltip","rotateLabelX","className","enableLegendSlider"]),ee=J,te=G||M?20:0,[ae,le]=s(60),ie=b(A,T),[oe,re]=n.useState(void 0),[ne,se]=s(void 0),ce=!!$;function me(e,t,a){var l,i,o,r;a.stopPropagation(),$&&(x(oe,Object.assign(Object.assign({},e.payload),{value:e.value}))?(se(void 0),re(void 0),null==$||$(null)):(se(null===(i=null===(l=e.tooltipPayload)||void 0===l?void 0:l[0])||void 0===i?void 0:i.dataKey),re(Object.assign(Object.assign({},e.payload),{value:e.value})),null==$||$(Object.assign({eventType:"bar",categoryClicked:null===(r=null===(o=e.tooltipPayload)||void 0===o?void 0:o[0])||void 0===r?void 0:r.dataKey},e.payload))))}const de=w(W,Y,q);return n.createElement("div",Object.assign({ref:j,className:i("w-full h-80",U)},_),n.createElement(c,{className:"h-full w-full"},(null==L?void 0:L.length)?n.createElement(m,{data:L,stackOffset:D?"sign":S?"expand":"none",layout:"vertical"===N?"vertical":"horizontal",onClick:ce&&(ne||oe)?()=>{re(void 0),se(void 0),null==$||$(null)}:void 0},H?n.createElement(d,{className:i("stroke-1","stroke-tremor-border","dark:stroke-dark-tremor-border"),horizontal:"vertical"!==N,vertical:"vertical"===N}):null,"vertical"!==N?n.createElement(v,{padding:{left:te,right:te},hide:!G,dataKey:O,interval:V?"preserveStartEnd":P,tick:{transform:"translate(0, 6)"},ticks:V?[L[0][O],L[L.length-1][O]]:void 0,fill:"",stroke:"",className:i("mt-4 text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,angle:null==Q?void 0:Q.angle,dy:null==Q?void 0:Q.verticalShift,height:null==Q?void 0:Q.xAxisHeight}):n.createElement(v,{hide:!G,type:"number",tick:{transform:"translate(-3, 0)"},domain:de,fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,tickFormatter:C,minTickGap:5,allowDecimals:I,angle:null==Q?void 0:Q.angle,dy:null==Q?void 0:Q.verticalShift,height:null==Q?void 0:Q.xAxisHeight}),"vertical"!==N?n.createElement(u,{width:z,hide:!M,axisLine:!1,tickLine:!1,type:"number",domain:de,tick:{transform:"translate(-3, 0)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickFormatter:S?e=>`${(100*e).toString()} %`:C,allowDecimals:I}):n.createElement(u,{width:z,hide:!M,dataKey:O,axisLine:!1,tickLine:!1,ticks:V?[L[0][O],L[L.length-1][O]]:void 0,type:"category",interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},fill:"",stroke:"",className:i("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content")}),n.createElement(h,{wrapperStyle:{outline:"none"},isAnimationActive:!1,cursor:{fill:"#d1d5db",opacity:"0.15"},content:X?({active:e,payload:a,label:l})=>ee?n.createElement(ee,{payload:null==a?void 0:a.map((e=>{var a;return Object.assign(Object.assign({},e),{color:null!==(a=ie.get(e.dataKey))&&void 0!==a?a:t.Gray})})),active:e,label:l}):n.createElement(f,{active:e,payload:a,label:l,valueFormatter:C,categoryColors:ie}):n.createElement(n.Fragment,null),position:{y:0}}),B?n.createElement(p,{verticalAlign:"top",height:ae,content:({payload:e})=>g({payload:e},ie,le,ne,ce?e=>{return t=e,void(ce&&(t!==ne||oe?(se(t),null==$||$({eventType:"category",categoryClicked:t})):(se(void 0),null==$||$(null)),re(void 0)));var t}:void 0,Z)}):null,A.map((e=>{var a;return n.createElement(y,{className:i(o(null!==(a=ie.get(e))&&void 0!==a?a:t.Gray,l.background).fillColor,$?"cursor-pointer":""),key:e,name:e,type:"linear",stackId:D||S?"a":void 0,dataKey:e,fill:"",isAnimationActive:K,animationDuration:F,shape:e=>((e,t,a,l)=>{const{fillOpacity:i,name:o,payload:r,value:s}=e;let{x:c,width:m,y:d,height:v}=e;return"horizontal"===l&&v<0?(d+=v,v=Math.abs(v)):"vertical"===l&&m<0&&(c+=m,m=Math.abs(m)),n.createElement("rect",{x:c,y:d,width:m,height:v,opacity:t||a&&a!==o?x(t,Object.assign(Object.assign({},r),{value:s}))?i:.3:i})})(e,oe,ne,N),onClick:me})}))):n.createElement(k,{noDataText:R})))}));E.displayName="BarChart";export{E as default};
