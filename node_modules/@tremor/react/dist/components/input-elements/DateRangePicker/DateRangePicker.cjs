'use client';
"use strict";var e=require("tslib"),r=require("@headlessui/react"),t=require("react"),a=require("../../../assets/CalendarIcon.cjs"),o=require("../../../assets/XCircleIcon.cjs"),n=require("date-fns"),l=require("../../../lib/shape.cjs"),d=require("../../../lib/sizing.cjs"),s=require("../../../lib/spacing.cjs"),i=require("../../../lib/tremorTwMerge.cjs"),u=require("../selectUtils.cjs"),m=require("./dateRangePickerUtils.cjs"),c=require("../Calendar/Calendar.cjs");require("../Select/Select.cjs");var g=require("../Select/SelectItem.cjs"),f=require("date-fns/locale"),b=require("../../../hooks/useInternalState.cjs");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var k=p(t);const v=n.startOfToday(),w=k.default.forwardRef(((p,w)=>{var h,x;const{value:y,defaultValue:N,onValueChange:T,enableSelect:E=!0,minDate:M,maxDate:S,placeholder:q="Select range",selectPlaceholder:j="Select range",disabled:C=!1,locale:D=f.enUS,enableClear:O=!0,displayFormat:X,children:P,className:R,enableYearNavigation:V=!1,weekStartsOn:z=0,disabledDates:F}=p,B=e.__rest(p,["value","defaultValue","onValueChange","enableSelect","minDate","maxDate","placeholder","selectPlaceholder","disabled","locale","enableClear","displayFormat","children","className","enableYearNavigation","weekStartsOn","disabledDates"]),[_,I]=b(N,y),[L,Y]=t.useState(!1),[U,A]=t.useState(!1),G=t.useMemo((()=>{const e=[];return M&&e.push({before:M}),S&&e.push({after:S}),[...e,...null!=F?F:[]]}),[M,S,F]),H=t.useMemo((()=>{const e=new Map;return P?k.default.Children.forEach(P,(r=>{var t;e.set(r.props.value,{text:null!==(t=u.getNodeText(r))&&void 0!==t?t:r.props.value,from:r.props.from,to:r.props.to})})):m.defaultOptions.forEach((r=>{e.set(r.value,{text:r.text,from:r.from,to:v})})),e}),[P]),J=t.useMemo((()=>{if(P)return u.constructValueToNameMapping(P);const e=new Map;return m.defaultOptions.forEach((r=>e.set(r.value,r.text))),e}),[P]),K=(null==_?void 0:_.selectValue)||"",Q=m.parseStartDate(null==_?void 0:_.from,M,K,H),W=m.parseEndDate(null==_?void 0:_.to,S,K,H),Z=Q||W?m.formatSelectedDates(Q,W,D,X):q,$=n.startOfMonth(null!==(x=null!==(h=null!=W?W:Q)&&void 0!==h?h:S)&&void 0!==x?x:v),ee=O&&!C;return k.default.createElement("div",Object.assign({ref:w,className:i.tremorTwMerge("w-full min-w-[10rem] relative flex justify-between text-tremor-default max-w-sm shadow-tremor-input dark:shadow-dark-tremor-input rounded-tremor-default",R)},B),k.default.createElement(r.Popover,{as:"div",className:i.tremorTwMerge("w-full",E?"rounded-l-tremor-default":"rounded-tremor-default",L&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10")},k.default.createElement("div",{className:"relative w-full"},k.default.createElement(r.Popover.Button,{onFocus:()=>Y(!0),onBlur:()=>Y(!1),disabled:C,className:i.tremorTwMerge("w-full outline-none text-left whitespace-nowrap truncate focus:ring-2 transition duration-100 rounded-l-tremor-default flex flex-nowrap","rounded-l-tremor-default border-tremor-border text-tremor-content-emphasis focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:border-dark-tremor-border dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",E?"rounded-l-tremor-default":"rounded-tremor-default",s.spacing.lg.paddingLeft,ee?s.spacing.fourXl.paddingRight:s.spacing.twoXl.paddingRight,s.spacing.sm.paddingY,l.border.sm.all,u.getSelectButtonColors(u.hasValue(Q||W),C))},k.default.createElement(a,{className:i.tremorTwMerge(m.makeDateRangePickerClassName("calendarIcon"),"flex-none shrink-0","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",d.sizing.lg.height,d.sizing.lg.width,s.spacing.threeXs.negativeMarginLeft,s.spacing.sm.marginRight),"aria-hidden":"true"}),k.default.createElement("p",{className:"truncate"},Z)),ee&&Q?k.default.createElement("button",{type:"button",className:i.tremorTwMerge("absolute outline-none inset-y-0 right-0 flex items-center transition duration-100",s.spacing.twoXl.marginRight),onClick:e=>{e.preventDefault(),null==T||T({}),I({})}},k.default.createElement(o,{className:i.tremorTwMerge(m.makeDateRangePickerClassName("clearIcon"),"flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",d.sizing.md.height,d.sizing.md.width)})):null),k.default.createElement(r.Transition,{className:"absolute z-10 min-w-min left-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},k.default.createElement(r.Popover.Panel,{focus:!0,className:i.tremorTwMerge("divide-y overflow-y-auto outline-none rounded-tremor-default p-3","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown",s.spacing.twoXs.marginTop,s.spacing.twoXs.marginBottom,l.border.sm.all)},k.default.createElement(c,Object.assign({mode:"range",showOutsideDays:!0,defaultMonth:$,selected:{from:Q,to:W},onSelect:e=>{null==T||T({from:null==e?void 0:e.from,to:null==e?void 0:e.to}),I({from:null==e?void 0:e.from,to:null==e?void 0:e.to})},locale:D,disabled:G,enableYearNavigation:V,classNames:{day_range_middle:i.tremorTwMerge("!rounded-none aria-selected:!bg-tremor-background-subtle aria-selected:dark:!bg-dark-tremor-background-subtle aria-selected:!text-tremor-content aria-selected:dark:!bg-dark-tremor-background-subtle"),day_range_start:"rounded-r-none rounded-l-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted",day_range_end:"rounded-l-none rounded-r-tremor-small aria-selected:text-tremor-brand-inverted dark:aria-selected:text-dark-tremor-brand-inverted"},weekStartsOn:z},p))))),E&&k.default.createElement(r.Listbox,{as:"div",className:i.tremorTwMerge("w-48 -ml-px rounded-r-tremor-default",U&&"ring-2 ring-tremor-brand-muted dark:ring-dark-tremor-brand-muted z-10"),value:K,onChange:e=>{const{from:r,to:t}=H.get(e),a=null!=t?t:v;null==T||T({from:r,to:a,selectValue:e}),I({from:r,to:a,selectValue:e})},disabled:C},(({value:e})=>{var t;return k.default.createElement(k.default.Fragment,null,k.default.createElement(r.Listbox.Button,{onFocus:()=>A(!0),onBlur:()=>A(!1),className:i.tremorTwMerge("w-full outline-none text-left whitespace-nowrap truncate rounded-r-tremor-default transition duration-100","border-tremor-border shadow-tremor-input text-tremor-content-emphasis focus:border-tremor-brand-subtle","dark:border-dark-tremor-border dark:shadow-dark-tremor-input dark:text-dark-tremor-content-emphasis dark:focus:border-dark-tremor-brand-subtle",s.spacing.twoXl.paddingLeft,s.spacing.twoXl.paddingRight,s.spacing.sm.paddingY,l.border.sm.all,u.getSelectButtonColors(u.hasValue(e),C))},e&&null!==(t=J.get(e))&&void 0!==t?t:j),k.default.createElement(r.Transition,{className:"absolute z-10 w-full inset-x-0 right-0",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},k.default.createElement(r.Listbox.Options,{className:i.tremorTwMerge("divide-y overflow-y-auto outline-none","shadow-tremor-dropdown bg-tremor-background border-tremor-border divide-tremor-border rounded-tremor-default","dark:shadow-dark-tremor-dropdown dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border",s.spacing.twoXs.marginTop,s.spacing.twoXs.marginBottom,l.border.sm.all)},null!=P?P:m.defaultOptions.map((e=>k.default.createElement(g,{key:e.value,value:e.value},e.text))))))})))}));w.displayName="DateRangePicker",module.exports=w;
