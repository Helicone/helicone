'use client';
import{__rest as e}from"tslib";import{border as t}from"../../../lib/shape.js";import{sizing as r}from"../../../lib/sizing.js";import{spacing as a}from"../../../lib/spacing.js";import{tremorTwMerge as o}from"../../../lib/tremorTwMerge.js";import{makeClassName as n}from"../../../lib/utils.js";import l,{useMemo as s,isValidElement as m,useState as d}from"react";import"../../../contexts/BaseColorContext.js";import"../../../contexts/IndexContext.js";import"../../../contexts/RootStylesContext.js";import c from"../../../contexts/SelectedValueContext.js";import i from"../../../hooks/useInternalState.js";import u from"../../../assets/ArrowDownHeadIcon.js";import p from"../../../assets/SearchIcon.js";import f from"../../../assets/XCircleIcon.js";import{Listbox as b,Transition as g}from"@headlessui/react";import h from"../../../assets/XIcon.js";import{getFilteredOptions as x,getSelectButtonColors as k}from"../selectUtils.js";const v=n("MultiSelect"),w=l.forwardRef(((n,w)=>{const{defaultValue:E,value:y,onValueChange:N,placeholder:j="Select...",placeholderSearch:C="Search",disabled:I=!1,icon:S,children:R,className:V}=n,X=e(n,["defaultValue","value","onValueChange","placeholder","placeholderSearch","disabled","icon","children","className"]),A=S,[D,B]=i(E,y),{reactElementChildren:T,optionsAvailable:F}=s((()=>{const e=l.Children.toArray(R).filter(m);return{reactElementChildren:e,optionsAvailable:x("",e)}}),[R]),[M,O]=d(""),z=(null!=D?D:[]).length>0,L=s((()=>M?x(M,T):F),[M,T,F]),P=()=>{O("")};return l.createElement(b,Object.assign({as:"div",ref:w,defaultValue:D,value:D,onChange:e=>{null==N||N(e),B(e)},disabled:I,className:o("w-full min-w-[10rem] relative text-tremor-default",V)},X,{multiple:!0}),(({value:e})=>l.createElement(l.Fragment,null,l.createElement(b.Button,{className:o("w-full outline-none text-left whitespace-nowrap truncate rounded-tremor-default focus:ring-2 transition duration-100","border-tremor-border shadow-tremor-input focus:border-tremor-brand-subtle focus:ring-tremor-brand-muted","dark:border-dark-tremor-border dark:shadow-dark-tremor-input dark:focus:border-dark-tremor-brand-subtle dark:focus:ring-dark-tremor-brand-muted",A?"p-10 -ml-0.5":a.lg.paddingLeft,a.fourXl.paddingRight,a.xs.paddingY,t.sm.all,k(e.length>0,I))},A&&l.createElement("span",{className:o("absolute inset-y-0 left-0 flex items-center ml-px",a.md.paddingLeft)},l.createElement(A,{className:o(v("Icon"),"flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",r.lg.height,r.lg.width)})),l.createElement("div",{className:"h-6 flex items-center"},e.length>0?l.createElement("div",{className:"flex flex-nowrap overflow-x-scroll [&::-webkit-scrollbar]:hidden [scrollbar-width:none] gap-x-1 mr-5 -ml-1.5 relative"},F.filter((t=>e.includes(t.props.value))).map(((t,r)=>{var a;return l.createElement("div",{key:r,className:o("max-w-[100px] lg:max-w-[200px] flex justify-center items-center pl-2 pr-1.5 py-1 font-medium","rounded-tremor-small","bg-tremor-background-muted dark:bg-dark-tremor-background-muted","bg-tremor-background-subtle dark:bg-dark-tremor-background-subtle","text-tremor-content-default dark:text-dark-tremor-content-default","text-tremor-content-emphasis dark:text-dark-tremor-content-emphasis")},l.createElement("div",{className:"text-xs truncate "},null!==(a=t.props.children)&&void 0!==a?a:t.props.value),l.createElement("div",{onClick:r=>{r.preventDefault();const a=e.filter((e=>e!==t.props.value));null==N||N(a),B(a)}},l.createElement(h,{className:o(v("clearIconItem"),"cursor-pointer rounded-tremor-full w-3.5 h-3.5 ml-2","text-tremor-content-subtle hover:text-tremor-content","dark:text-dark-tremor-content-subtle dark:hover:text-tremor-content")})))}))):l.createElement("span",null,j)),l.createElement("span",{className:o("absolute inset-y-0 right-0 flex items-center",a.md.marginRight)},l.createElement(u,{className:o(v("arrowDownIcon"),"flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",r.md.height,r.md.width)}))),z&&!I?l.createElement("button",{type:"button",className:o("absolute inset-y-0 right-0 flex items-center",a.fourXl.marginRight),onClick:e=>{e.preventDefault(),B([]),null==N||N([])}},l.createElement(f,{className:o(v("clearIconAllItems"),"flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",r.md.height,r.md.width)})):null,l.createElement(g,{className:"absolute z-10 w-full",enter:"transition ease duration-100 transform",enterFrom:"opacity-0 -translate-y-4",enterTo:"opacity-100 translate-y-0",leave:"transition ease duration-100 transform",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 -translate-y-4"},l.createElement(b.Options,{className:o("divide-y overflow-y-auto outline-none rounded-tremor-default max-h-[228px] left-0","bg-tremor-background border-tremor-border divide-tremor-border shadow-tremor-dropdown","dark:bg-dark-tremor-background dark:border-dark-tremor-border dark:divide-dark-tremor-border dark:shadow-dark-tremor-dropdown",a.twoXs.marginTop,a.twoXs.marginBottom,t.sm.all)},l.createElement("div",{className:o("flex items-center w-full","bg-tremor-background-muted","dark:bg-dark-tremor-background-muted",a.md.paddingX)},l.createElement("span",null,l.createElement(p,{className:o("flex-none","text-tremor-content-subtle","dark:text-dark-tremor-content-subtle",a.sm.marginRight,r.md.height,r.md.width)})),l.createElement("input",{name:"search",type:"input",autoComplete:"off",placeholder:C,className:o("w-full focus:outline-none focus:ring-none bg-transparent text-tremor-default","text-tremor-content-emphasis","dark:text-dark-tremor-content-emphasis",a.sm.paddingY),onKeyDown:e=>{"Space"===e.code&&""!==e.target.value&&e.stopPropagation()},onChange:e=>O(e.target.value),value:M})),l.createElement(c.Provider,Object.assign({},{onBlur:{handleResetSearch:P}},{value:{selectedValue:e}}),L))))))}));w.displayName="MultiSelect";export{w as default};
